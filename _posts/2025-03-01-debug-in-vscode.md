---
title: debug tools in vscode
tags:
  - projects
date: 2025-03-01
summary: 本文为本人在vscode上配置c/cpp debug的流程。
---

首先要确保你有c++ extensions。插件本身不具有编译功能，使用的是你电脑上的编译器。所以还要确保电脑上有编译器如clang g++等等。
# 用vscode运行，生成tasks.json文件
vscode只是一个文本编辑软件，他的GUI根据你的.json文件来执行相应的功能。比如vscode的设置其实就是在settings.json文件中更改相应的key和value即可。在你写完一个c或c++文件后，需要手动配置编译器 debug工具等等，这些也是需要用.json文件来指示。
写好第一个C++文件后，首次运行时vscode会检测你系统上具有的编译器 让你选择。选择后，会根据你的选择在当前文件夹的.vscode文件夹下生成tasks.json文件，记录了你运行编译的一些关键选项。下次就不需要选择了，因为下次会根据生成的tasks.json文件完成配置。

vscode+cpp file+cpp extensions+tasks.json 这四个就能运行和调试cpp文件。可以看[这个](https://zhuanlan.zhihu.com/p/348111473)帖子。以下提到的tasks.json文件可以让系统自动生成。

tasks.json文件实例：
```
{
  "tasks": [
    {
      "type": "cppbuild",
      "label": "C/C++: clang++ build active file",
      "command": "/usr/bin/clang++",
      "args": [
        "-fcolor-diagnostics",
        "-fansi-escape-codes",
        "-g",
        "${file}",
        "-o",
        "${fileDirname}/${fileBasenameNoExtension}"
      ],
      "options": {
        "cwd": "${fileDirname}"
      },
      "problemMatcher": ["$gcc"],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "detail": "Task generated by Debugger."
    }
  ],
  "version": "2.0.0"
}

```
具体的每个变量的含义在[这](https://code.visualstudio.com/docs/reference/variables-reference)里面。
简单说，
The command setting specifies the program to run. In this case, that is clang++.

The args array specifies the command-line arguments that are passed to clang++. These arguments must be specified in the order expected by the compiler.

This task tells the C++ compiler to take the active file (\${file}), compile it, and create an output file (-o switch) in the current directory (\${fileDirname}) with the same name as the active file but without the file extension (${fileBasenameNoExtension}). This process creates helloworld.

The label value is what you see in the tasks list, which is based on your personal preference.

The detail value is the description of the task in the tasks list. Update this string to differentiate it from similar tasks.

The problemMatcher value selects the output parser to use for finding errors and warnings in the compiler output. For clang++, the $gcc problem matcher creates the best results.

这个文件的目的就是每次点击运行后，用clang++编译文件helloworld.cpp生成可执行文件helloworld。
如果tasks里面有多个{}，就可以设置一个默认的。
```
    ......
"options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        },
        {
            "type": "cppbuild",
            "label": "C/C++: gcc build active file",
            "command": "/usr/bin/gcc",
    ......
```
group里面的isDefault设置了clang是默认的。取消默认直接"group":"build",即可。
In case you need to change the default compiler, you can run Tasks: Configure Default Build Task in the Command Palette. Alternatively you can modify the tasks.json file
# 用vscode debug文件
注意：在上文的tasks.json生成后就已经可以打断点，debug了。launch.json是为了个性化debug以及保存这个个性化。[官网](https://code.visualstudio.com/docs/cpp/config-clang-mac)的解释是：
```
When you debug with the play button or F5, the C++ extension creates a dynamic debug configuration on the fly.

There are cases where you'd want to customize your debug configuration, such as specifying arguments to pass to the program at runtime. You can define custom debug configurations in a launch.json file.
```
debug同样点击右上角的按钮，会让你选debug还是run。如果选debug，也会弹出来让你选择使用哪个工具。在设置了断点的情况下，就会进入正常的step in step out等流程。
debug的情况也在相同的位置有launch.json文件。以下是个例子：
``` 
{
  "configurations": [
    {
      "name": "C/C++: clang++ build and debug active file",
      "type": "cppdbg",
      "request": "launch",
      "program": "${fileDirname}/${fileBasenameNoExtension}",
      "args": [],
      "stopAtEntry": false,
      "cwd": "${fileDirname}",
      "environment": [],
      "externalConsole": false,
      "MIMode": "lldb",
      "preLaunchTask": "C/C++: clang++ build active file"
    }
  ],
  "version": "2.0.0"
}

```
The program setting specifies the program you want to debug. Here it is set to the active file folder \${fileDirname} and active filename ${fileBasenameNoExtension}, which if helloworld.cpp is the active file will be helloworld. 运行时传入的参数：The args property is an array of arguments to pass to the program at runtime.

By default, the C++ extension does not add any breakpoints to your source code and the stopAtEntry value is set to false.

Change the stopAtEntry value to true to cause the debugger to stop on the main method when you start debugging.

Ensure that the preLaunchTask value matches the label of the build task in the tasks.json file.

From now on, the play button and F5 will read from your launch.json file when launching your program for debugging.

